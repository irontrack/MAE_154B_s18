function rho = density(h)
  % computes air density at an altitude

  % this function computes the density of air for a given altitude
  % it does this by interpolating the US Standard Atmosphere table for given
  % altitudes and densities

  % @param  h   altitude for air density [m]
  % @return ro  density of air [kg m^-3]

  table = [-5000   76.84   32.189  17.554  27.45   3.836;
  0   59  32.174  14.696  23.77   3.737;
  5000  41.17   32.159  12.228  20.48   3.637;
  10000   23.36   32.143  10.108  17.56   3.534;
  15000   5.55  32.128  8.297   14.96   3.430;
  20000   -12.26  32.112  6.759   12.67   3.324;
  25000   -30.05  32.097  5.461   10.66   3.217;
  30000   -47.83  32.082  4.373   8.91  3.107;
  35000   -65.61  32.066  3.468   7.38  2.995;
  40000   -69.70  32.051  2.730   5.87  2.969;
  45000   -69.70  32.036  2.149   4.62  2.969;
  50000   -69.70  32.020  1.692   3.64  2.969;
  60000   -69.70  31.990  1.049   2.26  2.969;
  70000   -67.42  31.959  0.651   1.39  2.984;
  80000   -61.98  31.929  0.406   0.86  3.018;
  90000   -56.54  31.897  0.255   0.56  3.052;
  100000  -51.10  31.868  0.162   0.33  3.087;
  150000  19.40   31.717  0.020   0.037   3.511;
  200000  -19.78  31.566  0.003   0.0053  3.279;
  250000  -88.77  31.415  0.000   0.00065   2.846];

  % ft to m
  table(:, 1) = table(:, 1) * 0.3048000; 

  % slugs ft^-3 to kg m^-3
  table(:, 5) = table(:, 5) * 1e-4 * 515.378819; 

  
  rho = interp1(table(:, 1), table(:, 5), h, 'linear', 'extrap');
end
